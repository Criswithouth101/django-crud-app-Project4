<!DOCTYPE html>
<html>
<head><meta charset="utf-8"><title>{{ object.title }}</title></head>
<body>
  <h1>{{ object.title }}</h1>
  <p><strong>Author:</strong> {{ object.author }}</p>
  <p><strong>Published:</strong> {{ object.published_date }}</p>
  <p><strong>Price:</strong> {{ object.price }}</p>
  <p>{{ object.description }}</p>

  <p>
    {% if request.user == object.owner %}
      <a href="{% url 'books:edit' object.pk %}">Edit Book</a> |
      <a href="{% url 'books:delete' object.pk %}">Delete Book</a> |
    {% endif %}
    <a href="{% url 'books:index' %}">Back to list</a>
  </p>

  <hr>
  <h2>Reviews</h2>

  {% if user.is_authenticated %}
    <p><a href="{% url 'books:review_add' object.pk %}">Add a review</a></p>
  {% else %}
    <p><a href="{% url 'login' %}?next={{ request.path }}">Log in</a> to add a review.</p>
  {% endif %}

  {% if object.reviews.all %}
    <ul>
      {% for review in object.reviews.all %}
        <li>
          <strong>{{ review.rating }}/5</strong> â€” {{ review.content }}<br>
          <small>by {{ review.user.username }} on {{ review.created_at|date:"M d, Y H:i" }}</small>
          {% if user.is_authenticated and review.user == user %}
            <div>
              <a href="{% url 'books:review_edit' review.pk %}">Edit</a> |
              <a href="{% url 'books:review_delete' review.pk %}">Delete</a>
            </div>
          {% endif %}
        </li>
      {% empty %}
        <li>No reviews yet.</li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No reviews yet.</p>
  {% endif %}
</body>
</html>
